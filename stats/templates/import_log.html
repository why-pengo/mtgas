{% extends "base.html" %}

{% block title %}Import Log - MTG Arena Stats{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-8 offset-md-2">
        <h1 class="mb-4">Import Log File</h1>

        {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
            {% endfor %}
        {% endif %}

        <div class="card">
            <div class="card-body">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    
                    <div class="mb-4">
                        <label for="log_file" class="form-label">
                            <strong>Select Player.log File</strong>
                        </label>
                        <input 
                            type="file" 
                            class="form-control" 
                            id="log_file" 
                            name="log_file" 
                            accept=".log,.txt"
                            required
                        >
                        <div class="form-text">
                            Upload your MTG Arena Player.log file to import match data.
                        </div>
                    </div>

                    <div class="mb-4">
                        <div class="form-check">
                            <input 
                                type="checkbox" 
                                class="form-check-input" 
                                id="force" 
                                name="force"
                            >
                            <label class="form-check-label" for="force">
                                Force re-import (import all matches, even if already imported)
                            </label>
                        </div>
                    </div>

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary btn-lg">
                            Import Log File
                        </button>
                        <a href="{% url 'stats:import_sessions' %}" class="btn btn-secondary">
                            View Import History
                        </a>
                    </div>
                </form>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <strong>üìç Log File Locations</strong>
            </div>
            <div class="card-body">
                <h6>macOS</h6>
                <code>~/Library/Logs/Wizards Of The Coast/MTGA/Player.log</code>
                
                <h6 class="mt-3">Windows</h6>
                <code>%APPDATA%\..\LocalLow\Wizards Of The Coast\MTGA\Player.log</code>

                <h6 class="mt-3">Tips</h6>
                <ul class="mb-0">
                    <li>Import after gaming sessions to add new matches</li>
                    <li>Duplicate matches are automatically skipped (unless "Force re-import" is checked)</li>
                    <li>Large log files (100MB+) may take 1-2 minutes to process</li>
                    <li>Ensure Scryfall card data is downloaded first (run once)</li>
                </ul>
            </div>
        </div>

        <div class="alert alert-info mt-4">
            <strong>Note:</strong> If you haven't downloaded card data yet, import may fail. 
            Run <code>python manage.py download_cards</code> from the command line first (one-time setup).
        </div>
    </div>
</div>
{% endblock %}
